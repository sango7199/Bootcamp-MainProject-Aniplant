<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- 네임스페이스 설정 -->
<mapper namespace="mapper.category">

  <resultMap id="categoryResultMap" type="categoryVO">
  		<result property="category_num" column="category_num"/>
        <result property="parent_category_num" column="parent_category_num"/>
        <result property="name" column="name"/>
        <result property="read_permission" column="read_permission"/>
        <result property="write_permission" column="write_permission"/>
        <result property="created_user_num" column="created_user_num"/>
        <result property="created_at" column="created_at"/>
        <result property="updated_user_num" column="updated_user_num"/>
        <result property="updated_at" column="updated_at"/>
        <result property="is_deleted" column="is_deleted"/>
        <result property="deleted_user_num" column="deleted_user_num"/>
        <result property="deleted_at" column="deleted_at"/>
        </resultMap>
        
         <select id="getCategoryByCategoryNum" resultType="CategoryVO" parameterType="int">
        SELECT * FROM TB_CATEGORY WHERE category_num = #{categoryNum}
    </select>
    
    <!-- 카테고리 목록 조회 쿼리 -->
	<select id="selectCategoriesWithPaging"
		resultMap="categoryResultMap">
		SELECT * FROM TB_CATEGORY
		WHERE Is_Deleted = 0
		ORDER BY Category_Num DESC
		LIMIT #{cri.perPageNum} OFFSET #{cri.startRow}
	</select>

	<!-- 아이템 총 개수 조회 쿼리 -->
	<select id="getTotalCount" resultType="int">
		SELECT COUNT(*) FROM TB_CATEGORY
		WHERE Is_Deleted = 0
	</select>

	<!-- 검색 아이템 총 개수 조회 쿼리 -->
	<select id="getSelectTotalCount" resultType="int">
		SELECT COUNT(*) FROM TB_CATEGORY
		WHERE Is_Deleted = 0
		AND ${searchType} LIKE CONCAT('%', #{keyword}, '%')
	</select>

	<!-- 검색 쿼리 -->
	<select id="searchCategories" resultMap="categoryResultMap">
		SELECT * FROM TB_CATEGORY
		WHERE Is_Deleted = 0
		AND ${searchType} LIKE CONCAT('%', #{keyword}, '%')
		ORDER BY Category_Num DESC
		LIMIT #{perPageNum} OFFSET #{startRow}
	</select>
</mapper> 



	


